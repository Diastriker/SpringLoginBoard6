<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.board.mapper.BoardMapper">  

 	<select id="getTotalList" resultType="com.board.domain.BoardDTO">
 		SELECT IDX,
 					 TITLE,
 					 WRITER,
 					 TO_CHAR(REGDATE, 'YYYY-MM-DD') REGDATE,
 					 HIT
 		FROM BOARD
 		WHERE MENU_ID = #{menu_id}
 		ORDER BY IDX DESC
 	</select>
 	
 	<select id="getBoardList" resultType="com.board.domain.BoardDTO" parameterType="java.lang.String">
 	SELECT B.IDX, M.MENU_NAME, B.TITLE, B.CONTENT, B.WRITER, B.REGDATE, B.HIT
 	FROM BOARD B JOIN MENUS M ON B.MENU_ID = M.MENU_ID 
 	WHERE M.MENU_NAME = #{ menu_name }
 	</select>
 	
 	<insert id="insertBoard">
 		INSERT INTO BOARD ( IDX, MENU_ID, TITLE, CONTENT, WRITER )
 		VALUES ( 
 		( SELECT NVL(MAX(IDX),0)+1 FROM BOARD  ),
 			#{menu_id},
 			#{title},
 			#{content},
 			#{writer}
 		 )
 	</insert>
 	
 	<select id="getView" resultType="com.board.domain.BoardDTO">
 		SELECT IDX, MENU_ID, TITLE, CONTENT, WRITER, TO_CHAR(REGDATE, 'YYYY-MM-DD') REGDATE, HIT
 		FROM BOARD
 		WHERE IDX = #{idx}
 	</select>
 	
 	<!-- 조회수 증가(update) -->
 	<update id="incHit">
 			UPDATE BOARD
 			SET HIT = hit + 1
 			WHERE IDX = #{idx}
 	</update>
 	
 	<delete id="deleteView" >
 		DELETE FROM BOARD
 		WHERE IDX = #{ idx }
 	</delete>
 	
 	<select id="getViewList" resultType="com.board.domain.BoardDTO">
 		SELECT IDX, MENU_ID, TITLE, WRITER, CONTENT
 		FROM BOARD
 		WHERE IDX = #{idx}
 	</select>
 	
 	<update id="update" >
 		UPDATE BOARD
 		SET TITLE   = #{title}, 
 				CONTENT = #{content}
 		WHERE IDX   = #{idx}
 	</update>
</mapper>





